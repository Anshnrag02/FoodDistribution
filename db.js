const mysql = require('mysql');

let conf = {
	host: 'localhost',
	user: 'ravi',
	password: 'ravi',
	database: 'FoodDistribution'
}
//to store insert id generated by the ngo registration
let a;

function connection(){
	let conn = mysql.createConnection(conf);
	conn.connect();
	return conn;
}
//ngo registration
function ngoRegistration(done, register, login){
	let conn = connection();
	conn.query("insert into ngo set ?", register, function(err, results, fields){
		if (err) throw err;
		console.log(results);
		// done(login.username);
		login.ngo_id = parseInt(results.insertId);
		console.log(login.ngo_id);
		conn.query("insert into login set ?", login, function(err, results, fields){
			if(err) throw err;

			console.log(results);
			done(login.username);

		});
	})
}

//user registration
function userRegistration(done, register, login){
	let conn = connection();
	conn.query("insert into users set ?", register, function(err, results, fields){
		if (err) throw err;
		console.log(results);
		done(login.username);

	})
	conn.query("insert into login set ?", login, function(err, results, fields){
		if(err) throw err;
		console.log(results);
		done(login.username);

	});
}

// login module
function login(done, login){
	let a;

}

module.exports = {
	ngoRegistration: ngoRegistration,
	userRegistration: userRegistration
}